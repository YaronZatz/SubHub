kind: "AppStack"
schemaVersion: "v1"

runConfig:
  cpu: 1
  memoryMiB: 512

# Force npm run build (next build --webpack) so Tailwind/PostCSS run; Next.js 16 defaults to Turbopack which can skip PostCSS.
# runCommand ensures next start is used so the default .next output is found.
scripts:
  buildCommand: npm run build
  runCommand: next start

# Keep all build output (including .next) when using custom buildCommand; otherwise framework adapter optimizations may prune it.
outputFiles:
  serverApp:
    include: ["."]

# Set env vars and secrets in Firebase App Hosting; do not commit literal keys.
# See README or deploy doc for required: NEXT_PUBLIC_FIREBASE_*, GEMINI_API_KEY, NEXT_PUBLIC_APP_URL.
env:
  - variable: NEXT_PUBLIC_FIREBASE_API_KEY
    value: "NEXT_PUBLIC_FIREBASE_API_KEY"
    availability:
      - BUILD
      - RUNTIME
  - variable: NEXT_PUBLIC_FIREBASE_PROJECT_ID
    value: "NEXT_PUBLIC_FIREBASE_PROJECT_ID"
    availability:
      - BUILD
      - RUNTIME
  - variable: NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN
    value: "NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN"
    availability:
      - BUILD
      - RUNTIME
  - variable: GEMINI_API_KEY
    value: "GEMINI_API_KEY"
    availability:
      - BUILD
      - RUNTIME
