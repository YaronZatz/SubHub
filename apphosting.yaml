kind: "AppStack"
schemaVersion: "v1"

runConfig:
  cpu: 1
  memoryMiB: 512

scripts:
  buildCommand: npm run build
  runCommand: next start

outputFiles:
  serverApp:
    include: [ "." ]

env:
  # מפתחות ציבוריים (Client Side) - כאן value זה בסדר, רק וודא שהערך הוא המפתח האמיתי ולא המילה NEXT_PUBLIC...
  - variable: NEXT_PUBLIC_FIREBASE_API_KEY
    value: "YOUR_ACTUAL_API_KEY_HERE"
    availability: [BUILD, RUNTIME]
  
  - variable: NEXT_PUBLIC_FIREBASE_PROJECT_ID
    value: "gen-lang-client-0322888127"
    availability: [BUILD, RUNTIME]

  - variable: NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN
    value: "gen-lang-client-0322888127.firebaseapp.com"
    availability: [BUILD, RUNTIME]

  # --- סודות (Secrets) - כאן התיקון הקריטי ---
  
  # 1. מפתח Gemini
  - variable: GEMINI_API_KEY
    secret: GEMINI_API_KEY
    availability:
      - RUNTIME

  # 2. הגדרות Admin SDK (הסוד שקראנו לו בכספת FIREBASE_SERVICE_ACCOUNT_JSON)
  - variable: ADMIN_SDK_CONFIG
    secret: FIREBASE_SERVICE_ACCOUNT_JSON
    availability:
      - RUNTIME

  # 3. טוקן של Apify
  - variable: APIFY_API_TOKEN
    secret: APIFY_API_TOKEN
    availability:
      - RUNTIME